CREATE OR REPLACE VIEW SalesOrderItems AS SELECT soh.SalesOrderID AS orderID, sod.SalesOrderDetailID AS orderItemID, SUM(sod.OrderQty) AS quantityOrdered, AVG(sod.UnitPrice) AS unitPrice, SUM(sod.UnitPrice * sod.UnitPriceDiscount) AS discountAmount, SUM(sod.LineTotal) AS lineTotal, SUM(soh.TaxAmt) AS taxAmount, SUM(soh.Freight) AS freightCost, SUM(soh.TotalDue) AS totalOrderAmount, soh.OrderDate AS orderDate, soh.CustomerID AS customerID, sod.ProductID AS productID, soh.BillToAddressID AS billToAddressID, soh.ShipToAddressID AS shipToAddressID FROM SalesLT.SalesOrderHeader AS soh JOIN SalesLT.SalesOrderDetail AS sod ON soh.SalesOrderID = sod.SalesOrderID GROUP BY soh.SalesOrderID, sod.SalesOrderDetailID, soh.OrderDate, soh.CustomerID, sod.ProductID, soh.BillToAddressID, soh.ShipToAddressID;